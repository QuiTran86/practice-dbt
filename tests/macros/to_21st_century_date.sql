WITH test_data AS (
    SELECT '0021-09-23'::DATE as SRC_DATE, '2021-09-23'::DATE AS EXPECTED_DATE
    UNION
    SELECT '1021-09-24', '1021-09-24'
    UNION
    SELECT '2021-09-25', '2021-09-25'
    UNION
    SELECT '-0021-09-26', '1979-09-26'
    UNION
    SELECT '-0001-04-18', '1999-04-18'
)
SELECT {{ to_21st_century_date('SRC_DATE') }} as TRANSFORMED_DATE, EXPECTED_DATE,
    TRANSFORMED_DATE = EXPECTED_DATE AS MATCHING
FROM test_data
WHERE NOT MATCHING